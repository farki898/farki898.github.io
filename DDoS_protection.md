# วิธีตั้งค่า Service เพื่อป้องกัน DDoS

![](https://images.idgesg.net/images/article/2019/09/cso_nw_ddos_attacks_by_stevanovicigor_aka_igor_stevanovic_gettyimages-948533056_2400x1600-100811283-large.jpg)

ก่อนจะไปดูการตั้งค่ามาดูกันก่อนว่า DDoS คืออะไร?

การโจมตีแบบ DDoS แบบกระจายเป็นความพยายามที่เป็นอันตรายในการขัดขวางการรับส่งข้อมูลปกติของเซิร์ฟเวอร์บริการหรือเครือข่ายเป้าหมายโดยการครอบงำเป้าหมายหรือโครงสร้างพื้นฐานโดยรอบด้วยปริมาณการใช้อินเทอร์เน็ตจำนวนมาก

การโจมตี DDoS บรรลุประสิทธิผลโดยการใช้ระบบคอมพิวเตอร์ที่ถูกบุกรุกหลายระบบเป็นแหล่งที่มาของการรับส่งข้อมูลการโจมตี เครื่องที่ใช้ประโยชน์อาจรวมถึงคอมพิวเตอร์และทรัพยากรเครือข่ายอื่น ๆ เช่นอุปกรณ์ IoT
จากระดับสูงการโจมตี DDoS ก็เหมือนกับการจราจรติดขัดที่ไม่คาดคิดซึ่งอุดตันบนทางหลวงซึ่งป้องกันไม่ให้การจราจรปกติมาถึงปลายทาง

![](https://www.cloudflare.com/img/learning/ddos/what-is-a-ddos-attack/ddos-attack-traffic-metaphor.png)

### การโจมตี DDoS ทำงานอย่างไร?

การโจมตี DDoS ดำเนินการกับเครือข่ายของเครื่องที่เชื่อมต่ออินเทอร์เน็ต เครือข่ายเหล่านี้ประกอบด้วยคอมพิวเตอร์และอุปกรณ์อื่น ๆ (เช่นอุปกรณ์ IoT) ซึ่งติดมัลแวร์ทำให้ผู้โจมตีสามารถควบคุมได้จากระยะไกล อุปกรณ์เหล่านี้เรียกว่าบอท (หรือซอมบี้) และกลุ่มของบอทเรียกว่าบ็อตเน็ต

เมื่อสร้างบ็อตเน็ตแล้วผู้โจมตีสามารถสั่งการโจมตีได้โดยส่งคำสั่งระยะไกลไปยังบอทแต่ละตัว เมื่อเซิร์ฟเวอร์หรือเครือข่ายของเหยื่อตกเป็นเป้าหมายโดยบ็อตเน็ตบ็อตแต่ละตัวจะส่งคำขอไปยังที่อยู่ IP ของเป้าหมายซึ่งอาจทำให้เซิร์ฟเวอร์หรือเครือข่ายจมส่งผลให้เกิดการปฏิเสธการให้บริการในการรับส่งข้อมูลตามปกติ

เนื่องจากบ็อตแต่ละตัวเป็นอุปกรณ์อินเทอร์เน็ตที่ถูกต้องการแยกทราฟฟิกการโจมตีออกจากทราฟฟิกปกติอาจเป็นเรื่องยาก

### การตั้งค่าเพื่อป้องกัน

ต้องมีการตั้งค่าก่อนใช้บริการป้องกัน DDoS โปรดชี้โดเมนของคุณไปยังที่อยู่ IP ที่ให้ไว้และปรับการกำหนดค่าเว็บเซิร์ฟเวอร์ให้ทำงานกับ Service ต่างๆ
ค้นหาการตั้งค่าที่จำเป็นสำหรับเว็บเซิร์ฟเวอร์ต่างๆด้านล่าง

### Apache 2.4 - modremote_ip

```
RemoteIPHeader X-Real-IP

RemoteIPInternalProxy 127.0.0.1 81.91.182.0/23 93.189.63.240/28 93.189.61.240/28

93.189.62.240/28
```

### Apache 2.2 - mod_rpaf

```
RPAFenable On

RPAFsethostname On

RPAFproxy_ips 81.91.182.1 81.91.182.2 81.91.182.3 81.91.182.4

RPAFproxy_ips 81.91.182.5 81.91.182.6 81.91.182.7 81.91.182.8

RPAFproxy_ips 81.91.182.9 81.91.182.10 81.91.182.11 81.91.182.12

RPAFproxy_ips 81.91.182.13 81.91.182.14 81.91.182.15 81.91.182.16 81.91.182.17

RPAFproxy_ips 81.91.182.18 81.91.182.19 81.91.182.20 81.91.182.21

RPAFproxy_ips 81.91.182.22 81.91.182.23 81.91.182.24 81.91.182.25 81.91.182.26

RPAFproxy_ips 81.91.182.27 81.91.182.28 81.91.182.29 81.91.182.30

RPAFproxy_ips 81.91.182.31 81.91.182.32 81.91.182.33 81.91.182.34 81.91.182.35

RPAFproxy_ips 81.91.182.36 81.91.182.37 81.91.182.38 81.91.182.39

RPAFproxy_ips 81.91.182.40 81.91.182.41 81.91.182.42 81.91.182.43 81.91.182.44

RPAFproxy_ips 81.91.182.45 81.91.182.46 81.91.182.47 81.91.182.48

RPAFproxy_ips 81.91.182.49 81.91.182.50 81.91.182.51 81.91.182.52 81.91.182.53

RPAFproxy_ips 81.91.182.54 81.91.182.55 81.91.182.56 81.91.182.57

RPAFproxy_ips 81.91.182.58 81.91.182.59 81.91.182.60 81.91.182.61 81.91.182.62

RPAFproxy_ips 81.91.182.63 81.91.182.64 81.91.182.65 81.91.182.66

RPAFproxy_ips 81.91.182.67 81.91.182.68 81.91.182.69 81.91.182.70 81.91.182.71

RPAFproxy_ips 81.91.182.72 81.91.182.73 81.91.182.74 81.91.182.75

RPAFproxy_ips 81.91.182.76 81.91.182.77 81.91.182.78 81.91.182.79 81.91.182.80

RPAFproxy_ips 81.91.182.81 81.91.182.82 81.91.182.83 81.91.182.84

RPAFproxy_ips 81.91.182.85 81.91.182.86 81.91.182.87 81.91.182.88 81.91.182.89

RPAFproxy_ips 81.91.182.90 81.91.182.91 81.91.182.92 81.91.182.93

RPAFproxy_ips 81.91.182.94 81.91.182.95 81.91.182.96 81.91.182.97 81.91.182.98

RPAFproxy_ips 81.91.182.99 81.91.182.100 81.91.182.101 81.91.182.102

RPAFproxy_ips 81.91.182.103 81.91.182.104 81.91.182.105 81.91.182.106 81.91.182.107

RPAFproxy_ips 81.91.182.108 81.91.182.109 81.91.182.110 81.91.182.111

RPAFproxy_ips 81.91.182.112 81.91.182.113 81.91.182.114 81.91.182.115 81.91.182.116

RPAFproxy_ips 81.91.182.117 81.91.182.118 81.91.182.119 81.91.182.120

RPAFproxy_ips 81.91.182.121 81.91.182.122 81.91.182.123 81.91.182.124 81.91.182.125

RPAFproxy_ips 81.91.182.126 81.91.182.127 81.91.182.128 81.91.182.129

RPAFproxy_ips 81.91.182.130 81.91.182.131 81.91.182.132 81.91.182.133 81.91.182.134

RPAFproxy_ips 81.91.182.135 81.91.182.136 81.91.182.137 81.91.182.138

RPAFproxy_ips 81.91.182.139 81.91.182.140 81.91.182.141 81.91.182.142 81.91.182.143

RPAFproxy_ips 81.91.182.144 81.91.182.145 81.91.182.146 81.91.182.147

RPAFproxy_ips 81.91.182.148 81.91.182.149 81.91.182.150 81.91.182.151 81.91.182.152

RPAFproxy_ips 81.91.182.153 81.91.182.154 81.91.182.155 81.91.182.156

RPAFproxy_ips 81.91.182.157 81.91.182.158 81.91.182.159 81.91.182.160 81.91.182.161

RPAFproxy_ips 81.91.182.162 81.91.182.163 81.91.182.164 81.91.182.165

RPAFproxy_ips 81.91.182.166 81.91.182.167 81.91.182.168 81.91.182.169 81.91.182.170

RPAFproxy_ips 81.91.182.171 81.91.182.172 81.91.182.173 81.91.182.174

RPAFproxy_ips 81.91.182.175 81.91.182.176 81.91.182.177 81.91.182.178 81.91.182.179

RPAFproxy_ips 81.91.182.180 81.91.182.181 81.91.182.182 81.91.182.183

RPAFproxy_ips 81.91.182.184 81.91.182.185 81.91.182.186 81.91.182.187 81.91.182.188

RPAFproxy_ips 81.91.182.189 81.91.182.190 81.91.182.191 81.91.182.192

RPAFproxy_ips 81.91.182.193 81.91.182.194 81.91.182.195 81.91.182.196 81.91.182.197

RPAFproxy_ips 81.91.182.198 81.91.182.199 81.91.182.200 81.91.182.201

RPAFproxy_ips 81.91.182.202 81.91.182.203 81.91.182.204 81.91.182.205 81.91.182.206

RPAFproxy_ips 81.91.182.207 81.91.182.208 81.91.182.209 81.91.182.210

RPAFproxy_ips 81.91.182.211 81.91.182.212 81.91.182.213 81.91.182.214 81.91.182.215

RPAFproxy_ips 81.91.182.216 81.91.182.217 81.91.182.218 81.91.182.219

RPAFproxy_ips 81.91.182.220 81.91.182.221 81.91.182.222 81.91.182.223 81.91.182.224

RPAFproxy_ips 81.91.182.225 81.91.182.226 81.91.182.227 81.91.182.228

RPAFproxy_ips 81.91.182.229 81.91.182.230 81.91.182.231 81.91.182.232 81.91.182.233

RPAFproxy_ips 81.91.182.234 81.91.182.235 81.91.182.236 81.91.182.237

RPAFproxy_ips 81.91.182.238 81.91.182.239 81.91.182.240 81.91.182.241 81.91.182.242

RPAFproxy_ips 81.91.182.243 81.91.182.244 81.91.182.245 81.91.182.246

RPAFproxy_ips 81.91.182.247 81.91.182.248 81.91.182.249 81.91.182.250 81.91.182.251

RPAFproxy_ips 81.91.182.252 81.91.182.253 81.91.182.254

RPAFproxy_ips 81.91.183.1 81.91.183.2 81.91.183.3 81.91.183.4

RPAFproxy_ips 81.91.183.5 81.91.183.6 81.91.183.7 81.91.183.8

RPAFproxy_ips 81.91.183.9 81.91.183.10 81.91.183.11 81.91.183.12

RPAFproxy_ips 81.91.183.13 81.91.183.14 81.91.183.15 81.91.183.16 81.91.183.17

RPAFproxy_ips 81.91.183.18 81.91.183.19 81.91.183.20 81.91.183.21

RPAFproxy_ips 81.91.183.22 81.91.183.23 81.91.183.24 81.91.183.25 81.91.183.26

RPAFproxy_ips 81.91.183.27 81.91.183.28 81.91.183.29 81.91.183.30

RPAFproxy_ips 81.91.183.31 81.91.183.32 81.91.183.33 81.91.183.34 81.91.183.35

RPAFproxy_ips 81.91.183.36 81.91.183.37 81.91.183.38 81.91.183.39

RPAFproxy_ips 81.91.183.40 81.91.183.41 81.91.183.42 81.91.183.43 81.91.183.44

RPAFproxy_ips 81.91.183.45 81.91.183.46 81.91.183.47 81.91.183.48

RPAFproxy_ips 81.91.183.49 81.91.183.50 81.91.183.51 81.91.183.52 81.91.183.53

RPAFproxy_ips 81.91.183.54 81.91.183.55 81.91.183.56 81.91.183.57

RPAFproxy_ips 81.91.183.58 81.91.183.59 81.91.183.60 81.91.183.61 81.91.183.62

RPAFproxy_ips 81.91.183.63 81.91.183.64 81.91.183.65 81.91.183.66

RPAFproxy_ips 81.91.183.67 81.91.183.68 81.91.183.69 81.91.183.70 81.91.183.71

RPAFproxy_ips 81.91.183.72 81.91.183.73 81.91.183.74 81.91.183.75

RPAFproxy_ips 81.91.183.76 81.91.183.77 81.91.183.78 81.91.183.79 81.91.183.80

RPAFproxy_ips 81.91.183.81 81.91.183.82 81.91.183.83 81.91.183.84

RPAFproxy_ips 81.91.183.85 81.91.183.86 81.91.183.87 81.91.183.88 81.91.183.89

RPAFproxy_ips 81.91.183.90 81.91.183.91 81.91.183.92 81.91.183.93

RPAFproxy_ips 81.91.183.94 81.91.183.95 81.91.183.96 81.91.183.97 81.91.183.98

RPAFproxy_ips 81.91.183.99 81.91.183.100 81.91.183.101 81.91.183.102

RPAFproxy_ips 81.91.183.103 81.91.183.104 81.91.183.105 81.91.183.106 81.91.183.107

RPAFproxy_ips 81.91.183.108 81.91.183.109 81.91.183.110 81.91.183.111

RPAFproxy_ips 81.91.183.112 81.91.183.113 81.91.183.114 81.91.183.115 81.91.183.116

RPAFproxy_ips 81.91.183.117 81.91.183.118 81.91.183.119 81.91.183.120

RPAFproxy_ips 81.91.183.121 81.91.183.122 81.91.183.123 81.91.183.124 81.91.183.125

RPAFproxy_ips 81.91.183.126 81.91.183.127 81.91.183.128 81.91.183.129

RPAFproxy_ips 81.91.183.130 81.91.183.131 81.91.183.132 81.91.183.133 81.91.183.134

RPAFproxy_ips 81.91.183.135 81.91.183.136 81.91.183.137 81.91.183.138

RPAFproxy_ips 81.91.183.139 81.91.183.140 81.91.183.141 81.91.183.142 81.91.183.143

RPAFproxy_ips 81.91.183.144 81.91.183.145 81.91.183.146 81.91.183.147

RPAFproxy_ips 81.91.183.148 81.91.183.149 81.91.183.150 81.91.183.151 81.91.183.152

RPAFproxy_ips 81.91.183.153 81.91.183.154 81.91.183.155 81.91.183.156

RPAFproxy_ips 81.91.183.157 81.91.183.158 81.91.183.159 81.91.183.160 81.91.183.161

RPAFproxy_ips 81.91.183.162 81.91.183.163 81.91.183.164 81.91.183.165

RPAFproxy_ips 81.91.183.166 81.91.183.167 81.91.183.168 81.91.183.169 81.91.183.170

RPAFproxy_ips 81.91.183.171 81.91.183.172 81.91.183.173 81.91.183.174

RPAFproxy_ips 81.91.183.175 81.91.183.176 81.91.183.177 81.91.183.178 81.91.183.179

RPAFproxy_ips 81.91.183.180 81.91.183.181 81.91.183.182 81.91.183.183

RPAFproxy_ips 81.91.183.184 81.91.183.185 81.91.183.186 81.91.183.187 81.91.183.188

RPAFproxy_ips 81.91.183.189 81.91.183.190 81.91.183.191 81.91.183.192

RPAFproxy_ips 81.91.183.193 81.91.183.194 81.91.183.195 81.91.183.196 81.91.183.197

RPAFproxy_ips 81.91.183.198 81.91.183.199 81.91.183.200 81.91.183.201

RPAFproxy_ips 81.91.183.202 81.91.183.203 81.91.183.204 81.91.183.205 81.91.183.206

RPAFproxy_ips 81.91.183.207 81.91.183.208 81.91.183.209 81.91.183.210

RPAFproxy_ips 81.91.183.211 81.91.183.212 81.91.183.213 81.91.183.214 81.91.183.215

RPAFproxy_ips 81.91.183.216 81.91.183.217 81.91.183.218 81.91.183.219

RPAFproxy_ips 81.91.183.220 81.91.183.221 81.91.183.222 81.91.183.223 81.91.183.224

RPAFproxy_ips 81.91.183.225 81.91.183.226 81.91.183.227 81.91.183.228

RPAFproxy_ips 81.91.183.229 81.91.183.230 81.91.183.231 81.91.183.232 81.91.183.233

RPAFproxy_ips 81.91.183.234 81.91.183.235 81.91.183.236 81.91.183.237

RPAFproxy_ips 81.91.183.238 81.91.183.239 81.91.183.240 81.91.183.241 81.91.183.242

RPAFproxy_ips 81.91.183.243 81.91.183.244 81.91.183.245 81.91.183.246

RPAFproxy_ips 81.91.183.247 81.91.183.248 81.91.183.249 81.91.183.250 81.91.183.251

RPAFproxy_ips 81.91.183.252 81.91.183.253 81.91.183.254

RPAFproxy_ips 93.189.61.240 93.189.61.241 93.189.61.242

RPAFproxy_ips 93.189.61.243 93.189.61.244 93.189.61.245 93.189.61.246

RPAFproxy_ips 93.189.61.247 93.189.61.248 93.189.61.249 93.189.61.250 93.189.61.251

RPAFproxy_ips 93.189.61.252 93.189.61.253 93.189.61.254

RPAFproxy_ips 93.189.62.240 93.189.62.241 93.189.62.242

RPAFproxy_ips 93.189.62.243 93.189.62.244 93.189.62.245 93.189.62.246

RPAFproxy_ips 93.189.62.247 93.189.62.248 93.189.62.249 93.189.62.250 93.189.62.251

RPAFproxy_ips 93.189.62.252 93.189.62.253 93.189.62.254

RPAFproxy_ips 93.189.63.240 93.189.63.241 93.189.63.242

RPAFproxy_ips 93.189.63.243 93.189.63.244 93.189.63.245 93.189.63.246

RPAFproxy_ips 93.189.63.247 93.189.63.248 93.189.63.249 93.189.63.250 93.189.63.251

RPAFproxy_ips 93.189.63.252 93.189.63.253 93.189.63.254

RPAFheader X-Real-Ip
```

### Nginx - ngx_http_realip_module

```
set_real_ip_from 81.91.182.0/23; 

 set_real_ip_from 93.189.61.240/28

 set_real_ip_from 93.189.62.240/28

 set_real_ip_from 93.189.63.240/28

 real_ip_header     X-Real-IP;
```

หากเป็นที่อยู่ IP ที่ถูกโจมตีวิธีแก้ปัญหาที่เป็นไปได้คือการปิดกั้นการเข้าถึงภายนอกทั้งหมดยกเว้นเครือข่าย DDoS-Protection ที่มีไฟร์วอลล์

```
81.91.182.0/23

93.189.61.240/28

93.189.62.240/28

93.189.63.240/28
```


#### References:

- https://ispserver.com/help/ddos-protection
- https://www.cloudflare.com/en-ca/learning/ddos/what-is-a-ddos-attack/
